<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>API Corsi Pomeridiani - Documentazione</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            height: 100vh;
        }
        .sidebar {
            width: 250px;
            background: #2c3e50;
            color: #ecf0f1;
            overflow-y: auto;
        }
        .sidebar h2 {
            margin: 0;
            padding: 1em;
            background: #1a252f;
            font-size: 1.2em;
        }
        .menu, .submenu {
            list-style: none;
            margin: 0;
            padding: 0;
        }
        .menu > li {
            border-bottom: 1px solid #34495e;
        }
        .menu a,
        .accordion {
            display: block;
            padding: 0.75em 1em;
            color: inherit;
            text-decoration: none;
            background: none;
            border: none;
            width: 100%;
            text-align: left;
            cursor: pointer;
        }
        .menu a:hover,
        .accordion:hover {
            background: #34495e;
        }
        .submenu {
            display: none;
            background: #34495e;
        }
        .submenu li a {
            padding-left: 2em;
        }
        .content {
            flex: 1;
            overflow-y: auto;
            background: #f4f4f9;
            padding: 2em;
        }
        main section {
            display: none;
        }
        main section.active {
            display: block;
        }
        h2 {
            border-bottom: 2px solid #bdc3c7;
            padding-bottom: 0.3em;
        }
        pre {
            background: #ecf0f1;
            padding: 1em;
            overflow-x: auto;
        }
        code {
            background: #ecf0f1;
            padding: 0.2em 0.4em;
        }
        footer {
            text-align: center;
            padding: 1em;
            background: #ecf0f1;
        }
    </style>
</head>
<body>
    <nav class="sidebar">
        <h2>Menu</h2>
        <ul class="menu">
            <li><a href="#intro">Home</a></li>
            <li>
                <button class="accordion">Endpoints ▾</button>
                <ul class="submenu">
                    <li><a href="#login">Login</a></li>
                    <li><a href="#create-users">Creazione Utenti</a></li>
                    <li><a href="#gestione-corsi">Gestione Corsi</a></li>
                    <li><a href="#gestione-lezioni">Gestione Lezioni</a></li>
                    <li><a href="#gestione-iscrizioni">Gestione Iscrizioni</a></li>
                    <li><a href="#gestione-presenze">Gestione Presenze</a></li>
                    <li><a href="#assenze">Comunicazione Assenze</a></li>
                </ul>
            </li>
        </ul>
    </nav>
    <div class="content">
        <main>
            <section id="intro">
                <h2>Introduzione</h2>
                <p>Benvenuto nella documentazione dell'API per la gestione di corsi pomeridiani nelle scuole. Con questa API puoi:</p>
                <ul>
                    <li>Inviare richieste di registrazione per nuove scuole</li>
                    <li>Autenticare utenti con JWT</li>
                    <li>Gestire corsi, lezioni, iscrizioni e presenze</li>
                    <li>Registrare assenze e presenze</li>
                    <li>Controllare i log delle attività scolastiche</li>
                </ul>
            </section>

            <section id="login">
                <h2>Login</h2>
                <p><strong>POST</strong> <code>/auth/token</code>: autentica un utente e restituisce un JWT (<code>accessToken</code>).</p>
                <pre><code>{
  "username": "admin_x",
  "password": "password123"
}</code></pre>
            </section>

            <section id="create-users">
                <h2>Creazione Utenti</h2>
                <p>Protetto da JWT e autorizzazione (<code>amministratore</code>).</p>
                <p><strong>POST</strong> <code>/users</code>: crea un nuovo utente (docente o studente).</p>
                <pre><code>{
  "username": "docente1",
  "password": "pwdDocente",
  "ruolo": "docente"
}</code></pre>
            </section>

            <section id="gestione-corsi">
                <h2>Gestione Corsi</h2>
                <p><strong>POST</strong> <code>/corsi</code>: Crea un nuovo corso.</p>
                <p><strong>PUT</strong> <code>/corsi/:id/docente</code>: Assegna un docente a un corso esistente.</p>
                <p><strong>GET</strong> <code>/corsi</code>: Elenco dei corsi disponibili nella scuola.</p>
            </section>

            <section id="gestione-lezioni">
                <h2>Gestione Lezioni</h2>
                <p><strong>POST</strong> <code>/lezioni</code>: Crea una nuova lezione per un corso assegnato.</p>
                <p><strong>GET</strong> <code>/lezioni/:corso_id</code>: Visualizza le lezioni di un corso.</p>
                <p><strong>PUT</strong> <code>/lezioni/:id</code>: Modifica una lezione esistente.</p>
                <p><strong>DELETE</strong> <code>/lezioni/:id</code>: Elimina una lezione.</p>
            </section>

            <section id="gestione-iscrizioni">
                <h2>Gestione Iscrizioni</h2>
                <p>Questi endpoint gestiscono le iscrizioni degli studenti ai corsi.</p>
            
                <h3>Visualizza tutti i corsi con numero di iscritti</h3>
                <p><strong>GET</strong> <code>/iscrizioni</code></p>
                <p>Recupera l'elenco di tutti i corsi disponibili con il conteggio degli studenti iscritti a ciascuno. Richiede autenticazione.</p>
                <p><strong>Risposta di successo (esempio):</strong></p>
                <pre><code>[
              {
                "corso_id": 1,
                "nome_corso": "Matematica Avanzata",
                "descrizione_corso": "Corso avanzato di matematica.",
                "numero_iscritti": 15
              },
              {
                "corso_id": 2,
                "nome_corso": "Inglese Intermedio",
                "descrizione_corso": "Corso di inglese di livello intermedio.",
                "numero_iscritti": 22
              }
            ]</code></pre>
            
                <h3>Visualizza gli iscritti a un corso specifico</h3>
                <p><strong>GET</strong> <code>/iscrizioni/:id_corso</code></p>
                <p>Recupera l'elenco degli studenti iscritti al corso con l'ID specificato. Richiede autenticazione.</p>
                <p><strong>Parametri URL:</strong></p>
                <ul>
                    <li><code>id_corso</code>: L'ID del corso di cui visualizzare gli iscritti.</li>
                </ul>
                <p><strong>Risposta di successo (esempio):</strong></p>
                <pre><code>[
              {
                "studente_id": 101,
                "nome_studente": "Alice",
                "cognome_studente": "Rossi"
              },
              {
                "studente_id": 102,
                "nome_studente": "Bob",
                "cognome_studente": "Bianchi"
              }
            ]</code></pre>
            
                <h3>Iscrivi uno studente a un corso</h3>
                <p><strong>POST</strong> <code>/iscrizioni</code></p>
                <p>Iscrive lo studente autenticato a un corso specifico. Richiede autenticazione (ruolo 'studente').</p>
                <p><strong>Body della richiesta (application/json):</strong></p>
                <pre><code>{
              "corso_id": 123
            }</code></pre>
                <p><strong>Risposta di successo (201 Created):</strong></p>
                <pre><code>{
              "message": "Iscrizione al corso avvenuta con successo."
            }</code></pre>
            
                <h3>Cancella l'iscrizione di uno studente a un corso</h3>
                <p><strong>DELETE</strong> <code>/iscrizioni</code></p>
                <p>Permette allo studente autenticato di cancellare la propria iscrizione a un corso specifico. Richiede autenticazione (ruolo 'studente').</p>
                <p><strong>Body della richiesta (application/json):</strong></p>
                <pre><code>{
              "corso_id": 123
            }</code></pre>
                <p><strong>Risposta di successo (200 OK):</strong></p>
                <pre><code>{
              "message": "Disiscrizione dal corso avvenuta con successo."
            }</code></pre>
            
                <h3>Visualizza i corsi a cui lo studente è iscritto</h3>
                <p><strong>GET</strong> <code>/iscrizioni/mie-iscrizioni</code></p>
                <p>Recupera l'elenco dei corsi a cui lo studente autenticato è attualmente iscritto. Richiede autenticazione (ruolo 'studente').</p>
                <p><strong>Risposta di successo (esempio):</strong></p>
                <pre><code>[
              {
                "corso_id": 1,
                "nome_corso": "Matematica Avanzata",
                "descrizione_corso": "Corso avanzato di matematica."
              },
              {
                "corso_id": 3,
                "nome_corso": "Storia dell'Arte",
                "descrizione_corso": "Un viaggio nella storia dell'arte."
              }
            ]</code></pre>
            </section>

            <section id="gestione-presenze">
                <h2>Gestione Presenze</h2>
                <p><strong>POST</strong> <code>/presenze</code>: Registra la presenza o assenza di uno studente a una lezione.</p>
            </section>

            <section id="assenze">
                <h2>Comunicazione Assenze</h2>
                <p><strong>POST</strong> <code>/assenze</code>: Lo studente comunica l'assenza futura ad una lezione.</p>
            </section>
        </main>
        <footer>
            <p>Diego Stefanini, Andrea Romboli, Matteo Balinzo</p>
            <p>&copy; <a href="https://github.com/DiegoStefanini/api_corsi_pomeridiani/" target="_blank" rel="noopener">https://github.com/DiegoStefanini/api_corsi_pomeridiani/</a></p>
        </footer>
    </div>

    <script>
        // Sidebar accordion
        document.querySelectorAll('.accordion').forEach(btn => {
            btn.addEventListener('click', () => {
                const submenu = btn.nextElementSibling;
                submenu.style.display = submenu.style.display === 'block' ? 'none' : 'block';
            });
        });

        // Show only the clicked section
        const sections = document.querySelectorAll('main section');
        function showSection(id) {
            sections.forEach(sec => {
                sec.classList.toggle('active', sec.id === id);
            });
        }

        // Menu link clicks
        document.querySelectorAll('.menu a, .submenu a').forEach(link => {
            link.addEventListener('click', e => {
                e.preventDefault();
                const target = link.getAttribute('href').substring(1);
                showSection(target);
            });
        });

        // On load, show intro or hash
        window.addEventListener('load', () => {
            const hash = location.hash.substring(1);
            showSection(hash || 'intro');
        });
    </script>
</body>
</html>
